<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Test</title>
	<meta name="description" content="test">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<script src="https://d3js.org/d3.v7.min.js"></script>
	<script src="https://unpkg.com/scrollama"></script>
	<link rel="stylesheet" href="css/permutationTest.css">
	<link rel="stylesheet" href="css/style.css">
	<script src=assets/rough.min.js></script>
	<script src=assets/seedrandom.min.js></script>
</head>

<body>
	<main>
		<section id='intro'>
			<h1 class='intro__hed'>Scrollama</h1>
		</section>

		<section id='scrolly'>
			<figure>
				<div id="chart" style="border: 1px; background-color: aqua;">A NICE GRAPH</div>
			</figure>

			<article>
				<div class='step' data-step='0'>
					<p>Step 0</p>
				</div>
				<div class='step' data-step='1'>
					<p>Step 1</p>
				</div>
				<div class='step' data-step='2'>
					<p>Step 2</p>
				</div>
				<div class='step' data-step='3'>
					<p>Step 3</p>
				</div>
			</article>
		</section>
	</main>

	<script>

		const scroller = scrollama();

		function highlightLine(step) {
			switch (step) {
				case 0:
					// Show all lines at medium opacity
					d3.selectAll('.line-path').style('opacity', 0.6);
					break;
				case 1:
					// Highlight Pasta
					d3.select('.line-pasta').style('opacity', 1);
					break;
				case 2:
					// Highlight Pork
					d3.select('.line-pork').style('opacity', 1);
					break;
				case 3:
					// Highlight Eggs
					d3.select('.line-eggs').style('opacity', 1);
					break;
				case 4:
					// Highlight Hard Cheese
					d3.select('.line-hard-cheese').style('opacity', 1);
					break;
				case 5:
					// Highlight Carbonara Index
					d3.select('.line-carbonara-index').style('opacity', 1);
					break;
				case 6:
					// Highlight both Carbonara Index and KPI
					d3.select('.line-carbonara-index').style('opacity', 1);
					d3.select('.line-kpi-index').style('opacity', 1);
					break;
			}
		}

		// Setup scrollama
		scroller
			.setup({
				container: '#scrolly',
				step: '.step',
				offset: 0.5,
				debug: true
			})
			.onStepEnter(response => {
				const step = +response.element.dataset.step;
				highlightLine(step);

				// Update step styling
				d3.selectAll('.step').classed('is-active', false);
				d3.select(response.element).classed('is-active', true);
			});


	</script>
</body>

</html>